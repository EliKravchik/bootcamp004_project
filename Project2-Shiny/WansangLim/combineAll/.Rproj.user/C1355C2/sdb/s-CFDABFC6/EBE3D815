{
    "contents" : "library(shiny)\nlibrary(ggplot2)\n\nshinyServer(function(input, output) {\n  #data input\n  dataSalHis <- read.csv(\"../dataSalHis.csv\", stringsAsFactors=FALSE) #1 Graph\n  dataLevel <- read.csv(\"../levelPlotDa.csv\", stringsAsFactors=TRUE) # 2 Graph\n  compareOut <- read.csv(\"../compareOut.csv\") # 3 Graph\n  salaryByYYMM <- read.csv(\"../salaryByYYMM.csv\")\n\n\n  output$distPlot <- renderPlot({\n    \n    startYYMM <-input$rowNum\n    endYYMM <- startYYMM + 9\n    partData <- salaryByYYMM[startYYMM:endYYMM,]\n    \n    salaryInput <- reactive( {\n      switch(\n        input$salary,\n        \"minimum\" = 2,\n        \"maximum\" = 3,\n        \"average\" = 4)\n      })  \n  \n    salaryLevelInput <- reactive( {\n      switch(\n        input$salaryByLevel,\n        \"minimum\" = 4,\n        \"maximum\" = 5,\n        \"average\" = 6)\n    })\n    \n    outOrNot <- reactive({\n      switch(\n        input$OutNot,\n        \"Outlier\" = 1, \n        \"No Outlier\" = 2\n      )\n    })\n    \n    salaryTimeInput <- reactive( {\n      switch(\n        input$salary,\n        \"total number\" = \"total\",\n        \"minimum\" = \"SalaryFromAve\" ,\n        \"maximum\" = \"SalaryToAve\" ,\n        \"average\" = \"SalaryAveAve\" )\n    })\n    \n    aa <- salaryInput()\n    x    <- dataSalHis[, aa] \n    bins <- seq(min(x), max(x), length.out = input$bins + 1)\n    columnSel <- salaryLevelInput()\n    choice <- outOrNot()\n    colName <- salaryTimeInput()\n  \n  #Graph output\n    if (input$radio == 1) {\n      hist(x, breaks = bins, col = 'darkgray', border = 'white') #whole hist 1\n    } else if (input$radio == 2) {\n        plot(dataLevel[, 3], dataLevel[, columnSel]) # hist by Level\n    } else if (input$radio == 3) {\n        if (choice == 1) {\n          barGraph <- ggplot(compareOut, aes(x=OTitle, y=OAver)) + geom_bar(stat=\"identity\")\n          barGraph + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 12), panel.background = element_blank())\n      } else if (choice == 2) {\n          barGraph <- ggplot(compareOut, aes(x=NTitle, y=NAver)) + geom_bar(stat=\"identity\")\n          barGraph + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 12), panel.background = element_blank())\n      }\n    } else if (input$radio == 4) {\n      if (input$radioTime == 1) {\n        if (colName == \"total\") {\n          graphYYMM <- qplot(Posting.YYMM, total, data = salaryByYYMM)\n          graphYYMM + theme(axis.text.x = element_text(angle = 45, hjust = 1), \n                            panel.background = element_blank())\n        } else if (colName == \"SalaryFromAve\") {\n          graphYYMM <- qplot(Posting.YYMM, SalaryFromAve, data = salaryByYYMM)\n          graphYYMM + theme(axis.text.x = element_text(angle = 45, hjust = 1), \n                            panel.background = element_blank())\n        } else if (colName == \"SalaryToAve\") {\n          graphYYMM <- qplot(Posting.YYMM, SalaryToAve, data = salaryByYYMM)\n          graphYYMM + theme(axis.text.x = element_text(angle = 45, hjust = 1), \n                            panel.background = element_blank())\n        } else if (colName == \"SalaryAveAve\") {\n          graphYYMM <- qplot(Posting.YYMM, SalaryAveAve, data = salaryByYYMM)\n          graphYYMM + theme(axis.text.x = element_text(angle = 45, hjust = 1), \n                            panel.background = element_blank())\n        }\n        \n      } else if (input$radioTime == 2) {\n        \n        if (colName == \"total\") {\n          graphYYMM <- qplot(Posting.YYMM, total, data = partData)\n          graphYYMM + theme(axis.text.x = element_text(angle = 45, hjust = 1), \n                            panel.background = element_blank())\n        } else if (colName == \"SalaryFromAve\") {\n          graphYYMM <- qplot(Posting.YYMM, SalaryFromAve, data = partData)\n          graphYYMM + theme(axis.text.x = element_text(angle = 45, hjust = 1), \n                            panel.background = element_blank())\n        } else if (colName == \"SalaryToAve\") {\n          graphYYMM <- qplot(Posting.YYMM, SalaryToAve, data = partData)\n          graphYYMM + theme(axis.text.x = element_text(angle = 45, hjust = 1), \n                            panel.background = element_blank())\n        } else if (colName == \"SalaryAveAve\") {\n          graphYYMM <- qplot(Posting.YYMM, SalaryAveAve, data = partData)\n          graphYYMM + theme(axis.text.x = element_text(angle = 45, hjust = 1), \n                            panel.background = element_blank())\n        }\n      }\n    }\n  \n  }) #output$distPlot\n\n})\n",
    "created" : 1454971076502.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3958292870",
    "id" : "EBE3D815",
    "lastKnownWriteTime" : 1455042978,
    "path" : "/media/wan/64GB/NYC/project02/combineAll/server.R",
    "project_path" : "server.R",
    "properties" : {
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "type" : "r_source"
}